# VBA Stock  Analysis

## Overview of Project

### Purpose
Our friend Steve recently graduated from college with a finance degree and his proud parents became his first clients. His parents are passionate about green energy and were looking to invest in DAQO New Energy Corp (DQ). Steve promised to look into DAQ but concern about diversifying his parent’s portfolio, he wanted to analyze a handful of green energy stocks. Steve created an Excel file containing the stock data and requested for help to analyze and interpret the results using Visual Basic Applications (‘VBA’).

Steve was thrilled with the workbook I prepared for DAQO.  Now he wants to expand on the dataset he originally collected to include a universe of the stock market to use for any stock during the past few years.  The VBA created only works for a handful of stocks, in order for the programming language to work for other stocks, the VBA needs to be refactored.
 
Steps to take: 1.) the Module 2 code to loop through all the data one-time in order to collect the same information that you did in this Module, 2.) determine whether refactoring your codes successfully made the VBA script run faster and .3) you’ll need to present a written analysis that explains your findings.



## Results
**Please note, these are preliminary results.  Final result submissions are pending. Thank you for your cooperation.** 

### 2017 & 2018 Annual Trading Volume Performance:

When 2017 and 2018 is compared, it’s evident that 2017 was a better year than 2018. This is reflected in the annual returns of 10 out of 11 stocks.  In 2017, DAQO New Energy Corp ("DQ") with the lowest trading volume of all the stocks analyzed, yielded an impressive 199.4% return but took a deep dive in 2018 to a dismal -62.6%. However, SunPower Corporation (“SPWR”) which experienced the largest total daily volume, (782,187,000), in 2017, saw its 23.1% return decrease to -44.6% in 2018 with a lower 538,024,300 trading volume.  One can conclude that a higher active stock will not necessarily yield a positive annual return, there are many other underlying factors at play.

### All Stocks Analysis Refactor ![2017 and 2018 Comparison]( https://github.com/AQUINT01/stock-analysis/blob/master/All%20Stocks_2017and2018.png)

### 2017 & 2018 Execution Time Comparison:
**Please note, answer pending results from debugging and re-running the VBA_AllStocksAnalysisFactored file**

-  ### 2017 Execution Time![2017 Execution Time]( https://github.com/AQUINT01/stock-analysis/blob/master/Resources/VBA_Challenge_2017.png)

-   ### 2018 Execution Time![2018 Execution Time]( https://github.com/AQUINT01/stock-analysis/blob/master/Resources/VBA_Challenge_2018.png)



## Summary

**Please note, this is a preliminary summary. Final answers pending results from debugging and re-running the refactoring VBA.  Thank for your cooperation.**

### What are the advantages or disadvatanges of refactoring codes?

The advantages of refactoring according to *Marin Folwer* (father of Code Smell) are to… 
-  Improve the Design of Software
-  Makes Software Easier to Understand
-  Help Find Bug
-   Help Programming Faster
 
However, you shouldn’t refactor if it's risky when the application is too large, when the existing code doesn't have proper test cases and, lastly, when developers do not comprehend the task on hand.

In essence, refactoring is to improve the macro’s execution time due to less coding/syntax, thus reducing memory needed for computers to run.


### How do these pros and cons apply to refactoring the original VBA script?

 Upon refactoring the original VBA script, it’s clear  the script was contracted even though the new dataset increased.  Also, some syntax was rearranged which helps understand operational functions of the programming language, the operational structure flows better. 


